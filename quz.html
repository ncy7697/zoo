<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´ë“œ ì§ ë§ì¶”ê¸° ê²Œì„</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 100px);
            gap: 10px;
        }
        .card {
            width: 100px;
            height: 100px;
            background-color: #ddd;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .card.flipped {
            transform: rotateY(180deg);
            background-color: white;
            font-size: 40px;
        }
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        #level {
            font-size: 18px;
            margin-right: 10px;
        }
        #startGame {
            font-size: 18px;
            padding: 5px 10px;
        }
        #chances {
            font-size: 18px;
            margin-left: 10px;
        }
        #score {
            font-size: 18px;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <span id="levelDisplay">ë ˆë²¨: 1</span>
        <button id="startGame">ê²Œì„ ì‹œì‘</button>
        <span id="chances">ë‚¨ì€ ê¸°íšŒ: 5</span>
        <span id="score">ì ìˆ˜: 0</span>
    </div>
    <div class="game-board"></div>

    <script>
        const gameBoard = document.querySelector('.game-board');
        const levelDisplay = document.getElementById('levelDisplay');
        const startGameButton = document.getElementById('startGame');
        const emojis = ['ğŸ', 'ğŸŒ', 'ğŸ‡', 'ğŸŠ', 'ğŸ“', 'ğŸ‘', 'ğŸ', 'ğŸ¥', 'ğŸ‰', 'ğŸ', 'ğŸ’', 'ğŸ¥­', 'ğŸ‹', 'ğŸ¥‘', 'ğŸˆ', 'ğŸ'];
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let currentLevel = 1;
        let remainingChances = 5;
        let currentScore = 0;
        let totalScore = 0;
        const chancesDisplay = document.getElementById('chances');
        const scoreDisplay = document.getElementById('score');

        startGameButton.addEventListener('click', startGame);

        function startGame() {
            levelDisplay.textContent = `ë ˆë²¨: ${currentLevel}`;
            remainingChances = 5;
            chancesDisplay.textContent = `ë‚¨ì€ ê¸°íšŒ: ${remainingChances}`;
            scoreDisplay.textContent = `ì ìˆ˜: ${totalScore}`;

            const cardCount = Math.min(4 + Math.floor((currentLevel - 1) / 5) * 2, 32);
            const pairCount = cardCount / 2;
            cards = emojis.slice(0, pairCount).concat(emojis.slice(0, pairCount));
            cards.sort(() => Math.random() - 0.5);

            gameBoard.innerHTML = '';
            flippedCards = [];
            matchedPairs = 0;

            gameBoard.style.gridTemplateColumns = `repeat(${Math.ceil(Math.sqrt(cardCount))}, 100px)`;

            cards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.index = index;
                card.addEventListener('click', flipCard);
                gameBoard.appendChild(card);
            });
        }

        function flipCard() {
            if (flippedCards.length < 2 && !this.classList.contains('flipped')) {
                this.classList.add('flipped');
                this.textContent = cards[this.dataset.index];
                flippedCards.push(this);

                if (flippedCards.length === 2) {
                    setTimeout(checkMatch, 500);
                }
            }
        }

        function checkMatch() {
            const [card1, card2] = flippedCards;
            if (card1.textContent === card2.textContent) {
                card1.removeEventListener('click', flipCard);
                card2.removeEventListener('click', flipCard);
                matchedPairs++;
                currentScore += calculateScore();
                totalScore += currentScore;
                scoreDisplay.textContent = `ì ìˆ˜: ${totalScore}`;
                if (matchedPairs === cards.length / 2) {
                    setTimeout(() => {
                        alert(`ì¶•í•˜í•©ë‹ˆë‹¤! ë ˆë²¨ ${currentLevel}ì„ í´ë¦¬ì–´í•˜ì…¨ìŠµë‹ˆë‹¤! í˜„ì¬ ì´ì : ${totalScore}`);
                        currentLevel++;
                        startGame(); // ë‹¤ìŒ ë ˆë²¨ë¡œ ìë™ ì‹œì‘
                    }, 500);
                }
            } else {
                remainingChances--;
                chancesDisplay.textContent = `ë‚¨ì€ ê¸°íšŒ: ${remainingChances}`;
                if (remainingChances === 0) {
                    setTimeout(() => {
                        alert(`ê²Œì„ ì˜¤ë²„! ë ˆë²¨ ${currentLevel}ì—ì„œ ì‹¤íŒ¨í•˜ì…¨ìŠµë‹ˆë‹¤. ìµœì¢… ì ìˆ˜: ${totalScore}`);
                        currentLevel = 1; // ë ˆë²¨ ì´ˆê¸°í™”
                        totalScore = 0; // ì´ì  ì´ˆê¸°í™”
                        startGame(); // ê²Œì„ì„ ì¬ì‹œì‘í•©ë‹ˆë‹¤.
                    }, 500);
                } else {
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        card1.textContent = '';
                        card2.textContent = '';
                    }, 500);
                }
            }
            flippedCards = [];
        }

        function calculateScore() {
            // ë ˆë²¨ê³¼ ë‚¨ì€ ê¸°íšŒì— ë”°ë¼ ì ìˆ˜ ê³„ì‚°
            return currentLevel * 10 + remainingChances * 5;
        }
    </script>
</body>
</html>
